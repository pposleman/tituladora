<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ZÃ³calo</title>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">

<style>
body {
  margin: 0;
  background: transparent;
  font-family: 'Roboto Condensed', Arial, sans-serif;
}

#contenedor {
  position: absolute;
  width: 1920px;
  height: 1080px;
  opacity: 0;
  transition: opacity 0.3s ease;
}

#contenedor.visible {
  opacity: 1;
}

/* CAPAS */
.layer {
  position: absolute;
}

/* ORDEN */
.fondo-zocalo { z-index: 2; opacity: 0; transition: opacity 0.15s ease; }
.fondo-nombre { z-index: 1; opacity: 0; transform: translateY(30px); transition: opacity 0.3s ease, transform 0.3s ease; }
.texto-nombre { z-index: 3; }
.texto-zocalo { z-index: 4; }
.redes        { z-index: 5; opacity: 0; transition: opacity 0.3s ease; }

/* ESTADOS VISIBLES */
.fondo-zocalo.visible { opacity: 1; }
.fondo-nombre.visible { opacity: 1; transform: translateY(0); }
.redes.visible { opacity: 1; }

/* FONDOS */
.fondo-zocalo img,
.fondo-nombre img {
  width: 1920px;
  height: 1080px;
}

/* TEXTO NOMBRE */
.texto-nombre {
  bottom: 225px;
  left: 195px;
}

#nombre {
  font-size: 34px;
  font-weight: 700;
  color: #FFF;
  white-space: nowrap;

  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.25s ease, transform 0.25s ease;
}

#nombre.visible {
  opacity: 1;
  transform: translateY(0);
}

/* TEXTO ZÃ“CALO */
.texto-zocalo {
  bottom: 120px;
  left: 215px;
  right: 180px;
  height: 90px;
  display: flex;
  align-items: center;
}

#titulo {
  font-size: 45px;
  font-weight: 600;
  color: #a40000;
  line-height: 1.15;
}

/* REDES */
.redes img {
  bottom: 0;
  right: 0;
}
</style>
</head>

<body>

<div id="contenedor">

  <div class="layer fondo-zocalo">
    <img src="fondo-zocalo.png">
  </div>

  <div class="layer fondo-nombre">
    <img src="fondo-nombre.png">
  </div>

  <div class="layer texto-nombre">
    <div id="nombre"></div>
  </div>

  <div class="layer texto-zocalo">
    <div id="titulo"></div>
  </div>

  <div class="layer redes">
    <img src="redes.png">
  </div>

</div>


<script>
const firebaseConfig = {
  apiKey: "AIzaSyAYe51I6XTznRDXRiFPkrKTVf_Y8XEgeT8",
  authDomain: "zocalos-streaming-v1.firebaseapp.com",
  databaseURL: "https://zocalos-streaming-v1-default-rtdb.firebaseio.com",
  projectId: "zocalos-streaming-v1"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const contenedor   = document.getElementById("contenedor");
const fondoZocalo  = document.querySelector(".fondo-zocalo");
const fondoNombre  = document.querySelector(".fondo-nombre");
const nombre       = document.getElementById("nombre");
const titulo       = document.getElementById("titulo");
const redes        = document.querySelector(".redes");

/* MAQUINA DE ESCRIBIR */
function escribirTexto(el, texto) {
  el.textContent = "";
  let i = 0;
  (function escribir() {
    if (i < texto.length) {
      el.textContent += texto.charAt(i++);
      setTimeout(escribir, 10);
    }
  })();
}

/* ðŸ”¥ ESCUCHA SOLO LIVE */
db.ref("zocalo/live").on("value", snap => {
  const d = snap.val();
  if (!d) return;

  /* ===== OCULTAR ===== */
  if (!d.visible) {
    contenedor.classList.remove("visible");
    fondoZocalo.classList.remove("visible");
    fondoNombre.classList.remove("visible");
    nombre.classList.remove("visible");
    redes.classList.remove("visible");

    titulo.textContent = "";
    nombre.textContent = "";

    return;
  }

  /* ===== MOSTRAR ===== */
  contenedor.classList.add("visible");

  // 1. Fondo zÃ³calo
  setTimeout(() => {
    fondoZocalo.classList.add("visible");
  }, 0);

  // 2. Texto zÃ³calo
  setTimeout(() => {
    if (d.titulo) escribirTexto(titulo, d.titulo);
  }, 50);

  // 3. Fondo nombre
  setTimeout(() => {
    fondoNombre.classList.add("visible");
  }, 150);

  // 4. Texto nombre
  setTimeout(() => {
    if (d.nombreCargo) {
      nombre.textContent = d.nombreCargo;
      nombre.classList.add("visible");
    }
  }, 300);

  // 5. Redes
  setTimeout(() => {
    redes.classList.add("visible");
  }, 450);
});
</script>


</body>
</html>
